task
<hr />
micro
<hr />
context
<hr />

<script>
  // https://juejin.cn/post/6844903814659588110
  ;(function () {
    console.log(1)
    async function asyncfn1() {
      console.log(2)
      await asyncfn2()
      console.log(3)
    }
    setTimeout(() => {
      console.log('setTimeout')
    }, 0)

    async function asyncfn2() {
      console.log(4)
    }

    asyncfn1()
    console.log(5)
  })
  ;(function () {
    async function async1() {
      console.log('async1 start')
      await async2()
      console.log('async1 end')
    }
    async function async2() {
      console.log('async2')
    }
    console.log('script start')
    setTimeout(function () {
      console.log('setTimeout')
    }, 0)
    async1()
    new Promise(function (resolve) {
      console.log('promise1')
      resolve()
    }).then(function () {
      console.log('promise2')
    })
    console.log('script end')
  })
  ;(function () {
    console.log('script start')

    async function async1() {
      await async2()
      console.log('async1 end')
    }

    function async2() {
      console.log('async2 end')
    }
    async1()

    setTimeout(function () {
      console.log('setTimeout')
    }, 0)

    new Promise(resolve => {
      console.log('Promise')
      resolve()
    })
      .then(function () {
        console.log('promise1')
      })
      .then(function () {
        console.log('promise2')
      })

    console.log('script end')
  })
  ;(function () {
    const promise = new Promise((resolve, reject) => {
      console.log(1)
      resolve()
      console.log(2)
    })
    promise.then(() => {
      console.log(3)
    })
    console.log(4)
  })
  ;(function () {
    var promise = new Promise(function (resolve, reject) {
      setTimeout(function () {
        resolve(1)
      }, 100)
    })
    // 1
    promise
      .then(() => {
        return 3
      })
      .then(n => {
        console.log(n)
      })

    // 2
    // promise
    //   .then(() => {
    //     return 2
    //   })
    //   .then(n => {
    //     console.log(n)
    //   })

    // 3
    // promise.then(2).then(n => {
    //   console.log(n)
    // })
  })
  // 这个题目很有意思
  ;(function () {
    let a
    const b = new Promise((resolve, reject) => {
      console.log('promise1')
      resolve()
    })
      .then(() => {
        console.log('promise2')
      })
      .then(() => {
        console.log('promise3')
      })
      .then(() => {
        console.log('promise4')
      })

    a = new Promise(async (resolve, reject) => {
      console.log(a)
      await a
      console.log(a)
      console.log('after1')
      await b
      resolve(true)
      console.log('after2')
    })

    console.log('end')
  })()
  ;(function () {
    const promise = new Promise((resolve, reject) => {
      resolve('success1')
      reject('error')
      resolve('success2')
    })

    promise
      .then(res => {
        console.log('then: ', res)
      })
      .catch(err => {
        console.log('catch: ', err)
      })
  })
  ;(function () {
    Promise.resolve()
      .then(() => {
        return new Error('error!!!')
      })
      .then(res => {
        console.log('then: ', res)
      })
      .catch(err => {
        console.log('catch: ', err)
      })
  })
  ;(function () {
    const p1 = new Promise(resolve => {
      setTimeout(() => {
        resolve()
      }, 1000)
    })
    const p2 = new Promise(resolve => {
      setTimeout(() => {
        resolve()
      }, 1000)
    })
  })
  ;(function () {
    function* foo() {
      for (let i = 0; i < 3; i++) {
        yield i
      }
    }
    const gen = foo()
    for (let i = 0; i < 3; i++) {
      console.log(gen.next())
    }


  })
</script>
